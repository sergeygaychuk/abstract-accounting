<!DOCTYPE html>
<html>
<head>

  <%= stylesheet_link_tag 'jquery/ui-lightness/jquery-ui.css' %>
  <%= stylesheet_link_tag 'jquery/ui.jqgrid.css' %>
  <%= stylesheet_link_tag 'main_menu.css' %>

  <%= javascript_include_tag :defaults %>
  <%= javascript_include_tag 'locale/grid.locale-en.js' %>
  <%= javascript_include_tag 'jqgrid/grid.base.js' %>
  <%= javascript_include_tag 'jqgrid/grid.common.js' %>
  <%= javascript_include_tag 'jqgrid/grid.custom.js' %>
  <%= javascript_include_tag 'jqgrid/grid.formedit.js' %>
  <%= javascript_include_tag 'jqgrid/grid.inlinedit.js' %>
  <%= javascript_include_tag 'jqgrid/jquery.fmatter.js' %>
  <%= javascript_include_tag 'jqgrid/grid.celledit.js' %>
  <%= javascript_include_tag 'jqgrid/grid.subgrid.js' %>

  <%= javascript_include_tag 'utils.js' %>
  <%= javascript_include_tag 'menu.js' %>

  <%= csrf_meta_tag %>

  <%= yield(:head) %>

</head>
<body>

  <ul id="nav">
    <% if user_signed_in? %>
      <li><a href="#">Account</a>
        <ul>
          <li>
              <%= link_to('Logout', destroy_user_session_path) %>
          </li>
        </ul>
      </li>
    <% end %>
    <% if !current_user.nil? and
        (can?(:read, Entity) or can?(:read, [Asset, Money]) or
        can?(:read, Chart) or can?(:read, Quote) or can?(:read, Place)) %>
      <li>
        <a href="#">Manage</a>
        <ul>
          <% if can? :read, Place %>
            <li>
              <a href="#places" class="page_link">Place</a>
            </li>
          <% end %>
          <% if can? :read, Entity %>
            <li>
              <a href="#entities" class="page_link">Entity</a>
            </li>
          <% end %>
          <% if can? :read, Asset, Money %>
            <li>
              <a href="#resources" class="page_link">Resource</a>
            </li>
          <% end %>
          <% if can? :read, Chart %>
            <li>
              <a href="#charts" class="page_link">Chart</a>
            </li>
          <% end %>
          <% if can? :read, Quote %>
            <li>
              <a href="#quotes" class="page_link">Quote</a>
            </li>
          <% end %>
        </ul>
      </li>
    <% end %>
    <% if !current_user.nil? and
        (can?(:read, Deal) or can?(:manage, Fact)) %>
      <li>
        <a href="#">Process</a>
        <ul>
          <% if can?(:read, Deal) %>
            <li>
              <a href="#deals" class="page_link">Deal</a>
            </li>
          <% end %>
          <% if can?(:manage, Fact) %>
            <li>
              <a href="#facts" class="page_link">Fact</a>
            </li>
          <% end %>
        </ul>
      </li>
    <% end %>
    <% if !current_user.nil? and
        (can?(:manage, GeneralLedger) or can?(:manage, Balance) or
         can?(:manage, Transcript)) %>
      <li>
        <a href="#">Report</a>
        <ul>
          <% if can? :manage, GeneralLedger %>
            <li>
              <a href="#general_ledgers" class="page_link">GeneralLedger</a>
            </li>
          <% end %>
          <% if can? :manage, Balance %>
            <li>
              <a href="#balances" class="page_link">Balance</a>
            </li>
          <% end %>
          <% if can? :manage, Transcript %>
            <li>
              <a href="#transcripts" class="page_link">Transcript</a>
            </li>
          <% end %>
        </ul>
      </li>
    <% end %>
    <% if !current_user.nil? and
        (can?(:view, Storehouse) or can?(:view, Waybill) or
         can?(:list, StorehouseRelease)) %>
      <li>
        <a href="#">Storehouse</a>
        <ul>
          <% if can?(:view, Storehouse) %>
            <li>
              <a href="#storehouses" class="page_link">State</a>
            </li>
          <% end %>
          <% if can?(:view, Waybill) %>
            <li>
              <a href="#waybills" class="page_link">Waybills</a>
            </li>
          <% end %>
          <% if can?(:list, StorehouseRelease) %>
            <li>
              <a href="#storehouses/releases" class="page_link">Releases</a>
            </li>
          <% end %>
        </ul>
      </li>
    <% end %>
    <% if !current_user.nil? and current_user.entity.nil? then %>
      <li><a href="#">Administration</a>
        <ul>
          <li><a href="#users" class="page_link">User</a></li>
          <li><a href="#roles" class="page_link">Role</a></li>
        </ul>
      </li>
    <% end %>
  </ul>

  <%= yield %>

</body>
</html>
