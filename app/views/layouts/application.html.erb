<!DOCTYPE html>
<html>
<head>

  <%= stylesheet_link_tag 'jquery/ui-lightness/jquery-ui.css' %>
  <%= stylesheet_link_tag 'jquery/ui.jqgrid.css' %>
  <%= stylesheet_link_tag 'main_menu.css' %>

  <%= javascript_include_tag :defaults %>
  <%= javascript_include_tag 'locale/grid.locale-en.js' %>
  <%= javascript_include_tag 'jquery.grid.base.js' %>
  <%= javascript_include_tag 'jquery.grid.common.js' %>
  <%= javascript_include_tag 'jquery.grid.custom.js' %>
  <%= javascript_include_tag 'jquery.grid.formedit.js' %>
  <%= javascript_include_tag 'jquery.grid.inlinedit.js' %>
  <%= javascript_include_tag 'jquery.fmatter.js' %>
  <%= javascript_include_tag 'jquery.grid.celledit.js' %>
  <%= javascript_include_tag 'jquery.grid.subgrid.js' %>

  <%= javascript_include_tag 'utils.js' %>
  <%= javascript_include_tag 'menu.js' %>

  <%= csrf_meta_tag %>

  <%= yield(:head) %>

</head>
<body>

  <ul id="nav">
    <li><a href="#">Account</a>
      <ul>
        <li>
          <% if user_signed_in? %>
            <%= link_to('Logout', destroy_user_session_path) %>
          <% else %>
            <%= link_to('Login', new_user_session_path)  %>
          <% end %>
        </li>
      </ul>
    </li>
    <% if current_user != nil and
        (can?(:read, Entity) or can?(:read, [Asset, Money]) or
        can?(:read, Chart) or can?(:read, Quote)) %>
      <li>
        <a href="#">Manage</a>
        <ul>
          <% if current_user != nil and can? :read, Entity %>
            <li>
              <a href="#entities" class="page_link">Entity</a>
            </li>
          <% end %>
          <% if current_user != nil and can? :read, Asset, Money %>
            <li>
              <a href="#resources" class="page_link">Resource</a>
            </li>
          <% end %>
          <% if current_user != nil and can? :read, Chart %>
            <li>
              <a href="#charts" class="page_link">Chart</a>
            </li>
          <% end %>
          <% if current_user != nil and can? :read, Quote %>
            <li>
              <a href="#quotes" class="page_link">Quote</a>
            </li>
          <% end %>
        </ul>
      </li>
    <% end %>
    <% if current_user != nil and
        (can?(:read, Deal) or can?(:manage, Fact)) %>
      <li>
        <a href="#">Process</a>
        <ul>
          <% if current_user != nil and can?(:read, Deal) %>
            <li>
              <a href="#deals" class="page_link">Deal</a>
            </li>
          <% end %>
          <% if current_user != nil and can?(:manage, Fact) %>
            <li>
              <a href="#facts" class="page_link">Fact</a>
            </li>
          <% end %>
        </ul>
      </li>
    <% end %>
    <% if current_user != nil and
        (can?(:manage, GeneralLedger) or can?(:manage, Balance) or
         can?(:manage, Transcript)) %>
      <li>
        <a href="#">Report</a>
        <ul>
          <% if current_user != nil and can? :manage, GeneralLedger %>
            <li>
              <a href="#general_ledgers" class="page_link">GeneralLedger</a>
            </li>
          <% end %>
          <% if current_user != nil and can? :manage, Balance %>
            <li>
              <a href="#balances" class="page_link">Balance</a>
            </li>
          <% end %>
          <% if current_user != nil and can? :manage, Transcript %>
            <li>
              <a href="#transcripts" class="page_link">Transcript</a>
            </li>
          <% end %>
        </ul>
      </li>
    <% end %>
    <% if current_user != nil and current_user.entity_id == 0 then %>
    <li><a href="#">Administration</a>
      <ul>
        <li><a href="#users" class="page_link">User</a></li>
        <li><a href="#roles" class="page_link">Role</a></li>
      </ul>
    </li>
    <% end %>
  </ul>

  <%= yield %>

</body>
</html>
