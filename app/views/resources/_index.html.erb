<script type="text/javascript">
  var canSelectResource = true;
  var selResId = 0;
  var moneyCode = "";
  var resourceTag = "";

  function showResourceActionForm(resType, actionType)
  {
    if(resType == "asset") {
      $("#div_money_code").css("display","none");
      moneyCode = "";
      $("#resource_type").removeAttr("checked");
    } else {
      $("#div_money_code").css("display","block");
      moneyCode = unescape($("#hide_money_code").val());
    }
    resourceTag = unescape($("#hide_" + resType + "_tag").val());
    $("#money_code").val(moneyCode);
    $("#resource_tag").val(resourceTag);
    $("#resource_tag").removeAttr("disabled");
    if(actionType == "new") $("#resource_type").removeAttr("disabled");
    $("#money_code").removeAttr("disabled");
    $("#resources_list").resetSelection();
    canSelectResource = false;
  }
  function showResourceIndexForm(id)
  {
    if(id != null) {
      editRowId = id;
    }
    if(crossPage.length) {
      canSelectResource = true;
      $("#resource_actions").html("<%= escape_javascript(render :partial => 'resources/form_index') %>");
      moneyCode = "";
      resourceTag = "";
      $("#money_code").val("");
      $("#resource_tag").val("");
      $("#resource_tag").attr("disabled","disabled");
      $("#resource_type").attr("disabled","disabled");
      $("#money_code").attr("disabled","disabled");
      $("#resources_list").trigger("reloadGrid");
      cancelRequest = true;
      location.hash = crossPageLink;
    } else {
      location.hash = "#resources";
    }
  }
  function sendAsset()
  {
    submitId = "save_resource";
    $("#hide_asset_tag").val(escape($("#resource_tag").val()));
  }
  function sendMoney()
  {
    submitId = "save_resource";
    $("#hide_money_code").val(escape($("#money_code").val()));
    $("#hide_money_tag").val(escape($("#resource_tag").val()));
  }
  function onResetResource()
  {
    $("#resource_tag").val(resourceTag);
    $("#money_code").val(moneyCode);
    $("#save_resource").attr("disabled","disabled");
  }
  function onCancelResource()
  {
    showResourceIndexForm();
  }
  function changeResourceType()
  {
    if($("#resource_type").attr("checked"))
    {
      location.hash = "#resources/new_money";
    }
    else
    {
      location.hash = "#resources/new_asset";
    }
  }
  function getResType(type) {
    if(type == "Asset") return "<%= t('resource.asset')%>";
    return "<%= t('resource.money')%>";
  }
</script>

<%= raw(resources_jqgrid) %>


<table>
  <tr>
    <td colspan="2" id="resource_errors"></td>
  </tr>
  <tr>
    <td colspan="2">
      <table id="resources_list"></table>
      <div id="resources_pager"></div>
    </td>
  </tr>
  <tr id="resource_actions" align="right">
    <%= render 'resources/form_index' %>
  </tr>
  <tr align="left">
    <td colspan="2">
      <div style="float:left">
        <%= t('resource.ismoney')%>:
        <input id="resource_type" type="checkbox" onchange="changeResourceType();"
               disabled="true"/>
      </div>
      <div id="div_money_code" style="float:right; display:none">
        <%= t('resource.code')%>:
        <input id="money_code" type="text" value="" size="20" disabled="true"
               onkeypress="$('#save_resource').removeAttr('disabled');"/>
      </div>
    </td>
  </tr>
  <tr align="left">
    <td colspan="2">
      <%= t('resource.tag')%>:
      <input id="resource_tag" type="text" value="" size="83" disabled="true"
             onkeypress="$('#save_resource').removeAttr('disabled');"/>
    </td>
  </tr>
</table>

<script type="text/javascript">
  var filter = false;
  $("#resources_list").filterToolbar({searchOnEnter : false});
  $("#resources_list")[0].toggleToolbar();
</script>
